const _0x513bc6=_0x709d;(function(_0x28e915,_0x267628){const _0xa4fb20=_0x709d,_0x49abc0=_0x28e915();while(!![]){try{const _0x27aeaf=-parseInt(_0xa4fb20(0x7c))/0x1+-parseInt(_0xa4fb20(0x93))/0x2+-parseInt(_0xa4fb20(0xa7))/0x3+-parseInt(_0xa4fb20(0xc2))/0x4*(parseInt(_0xa4fb20(0x9b))/0x5)+parseInt(_0xa4fb20(0xa6))/0x6+parseInt(_0xa4fb20(0xb3))/0x7*(parseInt(_0xa4fb20(0x88))/0x8)+parseInt(_0xa4fb20(0x97))/0x9;if(_0x27aeaf===_0x267628)break;else _0x49abc0['push'](_0x49abc0['shift']());}catch(_0x4f8a52){_0x49abc0['push'](_0x49abc0['shift']());}}}(_0x7ab6,0xb9d04));const newRandomArray=_0x237121=>{const _0x22a68f=_0x709d,_0x25b1d9=Array[_0x22a68f(0xc6)](_0x237121);for(let _0x1cbb35=_0x25b1d9[_0x22a68f(0x7e)]-0x1;_0x1cbb35>=0x0;_0x1cbb35--){const _0x25d383=Math[_0x22a68f(0x70)](Math[_0x22a68f(0x77)]()*(_0x1cbb35+0x1));[_0x25b1d9[_0x1cbb35],_0x25b1d9[_0x25d383]]=[_0x25b1d9[_0x25d383],_0x25b1d9[_0x1cbb35]];}return _0x25b1d9;},nextRandomString=()=>{const _0x153827=_0x709d;return Math['random']()[_0x153827(0x86)](0x24)[_0x153827(0x9e)](0x2)['padEnd'](0xb,'0');},getRandomStrings=_0x5d07b4=>{const _0xa1b692=new Set();while(_0xa1b692['size']<_0x5d07b4){_0xa1b692['add'](nextRandomString());}return Array['from'](_0xa1b692);},getRandomRanged=(_0x322112,_0x4af7fd)=>{const _0xde5ea3=_0x709d;return Math[_0xde5ea3(0x70)](_0x322112+Math[_0xde5ea3(0x77)]()*(_0x4af7fd-_0x322112));},getRankedArray=(_0x1c4a39,_0x224f56)=>{const _0x59bee9=_0x709d,_0x43314c=_0x1c4a39[_0x59bee9(0x80)](_0x318ae1=>Object[_0x59bee9(0x9f)]({},_0x318ae1))[_0x59bee9(0xb6)](_0x224f56);return _0x43314c[_0x59bee9(0x83)]((_0x34c2d4,_0x4fc8f9,_0x1b04ed)=>{const _0x4955af=_0x59bee9;return!_0x34c2d4?_0x4fc8f9[_0x4955af(0xb8)]=0x1:_0x4fc8f9['rank']=_0x224f56(_0x4fc8f9,_0x34c2d4)===0x0?_0x34c2d4[_0x4955af(0xb8)]:_0x1b04ed+0x1,_0x4fc8f9;},null),_0x43314c;},express=require('express'),app=express();function _0x7ab6(){const _0x47b676=['floor','joinroom_room_is_full','room_is_full','toFixed','size','userName','appId','random','readyCount','cards','delete','Server','1344627ohwiYs','./conf.json','length','takenTimeMS','map','value','playing_now','reduce','leave','prepare_play','toString','tag','2336mxstTd','static','sockets','forEach','values','restCards','currentCard','currentIndex','to_waiting_room','takenTimeSec','getMemberList','2399214TVtybX','actedDataMap','ready_play','socket.io','21610260CsTOBL','useCardCount','splice','room','50FhRELI','room_member_list','env','substring','assign','next','reason','card_phase_update_actinfo','all_ready_play','has','card_phase_card_result','6826938nBQOkn','2335713fkzvLN','initialize','minTakenTimeMS','ownerUserName','leaveMember','click','connection','get','dataId','cardId','joinroom_invaid_parameter','emit','29449DRwqWc','set','wrong','sort','action','rank','user_disconnect_in_game','all_ready_next_card','game','correct','fastestUserName','duplicated_usename','joinMember','add','userPointsMap','273404LUUqXw','join_room','currentTag','slice','from','http','clear','card_phase_acted','MAX_VALUE','join','leave_room','finish_play','totalCount','userNameMaxLength','game_end','members','\x20文字以下にしてください','memberCount','play','PORT','roomName','leave_room_ok','joinroom_duplicated_usename'];_0x7ab6=function(){return _0x47b676;};return _0x7ab6();}app['use'](express[_0x513bc6(0x89)]('public'));const http=require(_0x513bc6(0xc7))[_0x513bc6(0x7b)](app);http['listen'](process[_0x513bc6(0x9d)][_0x513bc6(0xd5)]||0xbb8);const io=require(_0x513bc6(0x96))(http),rooms=((()=>{const _0xa57c55=new Map(),_0x256168=_0x200598=>{return{'play':![],'game':{'actedDataMap':new Map(),'userPointsMap':new Map()},'ownerUserName':_0x200598,'members':new Set([_0x200598]),'getMemberList':function(){const _0x2aa1f1=_0x709d;return Array[_0x2aa1f1(0xc6)](this[_0x2aa1f1(0xd1)]);}};};return{'getMemberList':_0x396cc1=>{const _0x227cf2=_0x709d;return _0xa57c55['get'](_0x396cc1)?.[_0x227cf2(0x92)]()??[];},'joinMember':(_0x331cd1,_0x4e9207,_0x269771)=>{const _0x35a116=_0x709d;if(!_0xa57c55['has'](_0x331cd1)){const _0x39768d=_0x256168(_0x4e9207);return _0xa57c55[_0x35a116(0xb4)](_0x331cd1,_0x39768d),{'success':!![],'room':_0x39768d};}else{const _0x33b7a1=_0xa57c55[_0x35a116(0xae)](_0x331cd1);if(_0x33b7a1[_0x35a116(0xd4)])return{'success':![],'reason':_0x35a116(0x82)};if(_0x33b7a1[_0x35a116(0xd1)]['size']>=conf['maxUserInRoom'])return{'success':![],'reason':'room_is_full'};return _0x33b7a1[_0x35a116(0xd1)][_0x35a116(0xa4)](_0x4e9207)?{'success':![],'reason':_0x35a116(0xbe)}:(_0x33b7a1[_0x35a116(0xd1)][_0x35a116(0xc0)](_0x4e9207),{'success':!![],'room':_0x33b7a1});}},'leaveMember':(_0x4de7c2,_0x1c13bd)=>{const _0x555de2=_0x709d,_0x323c20=_0xa57c55['get'](_0x4de7c2);if(!_0x323c20)return;const _0x298ce8=_0x323c20[_0x555de2(0xd1)];_0x298ce8[_0x555de2(0x7a)](_0x1c13bd),_0x298ce8['size']===0x0&&_0xa57c55[_0x555de2(0x7a)](_0x4de7c2),_0x1c13bd===_0x323c20[_0x555de2(0xaa)]&&(_0x323c20[_0x555de2(0xaa)]=_0x298ce8[_0x555de2(0x8c)]()[_0x555de2(0xa0)]()[_0x555de2(0x81)]);}};})());function _0x709d(_0x13b313,_0x21af17){const _0x7ab63c=_0x7ab6();return _0x709d=function(_0x709d46,_0x512da6){_0x709d46=_0x709d46-0x6d;let _0x333f2a=_0x7ab63c[_0x709d46];return _0x333f2a;},_0x709d(_0x13b313,_0x21af17);}let userNumber=0x0;const conf=require(_0x513bc6(0x7d));io[_0x513bc6(0x8a)]['on'](_0x513bc6(0xad),_0x373fba=>{const _0x53f9eb=_0x513bc6,_0x542c01={};let _0x3e9ce3;io['to'](_0x373fba['id'])[_0x53f9eb(0xb2)](_0x53f9eb(0xa8),{'userNameMaxLength':conf[_0x53f9eb(0xcf)],'userNumber':++userNumber});const _0x5da4c3=_0x4776da=>{const _0x5aecd5=_0x53f9eb;return{'memberList':_0x4776da[_0x5aecd5(0x92)](),'ownerUserName':_0x4776da[_0x5aecd5(0xaa)]};};_0x373fba['on'](_0x53f9eb(0xc3),_0x4e4fa1=>{const _0x730a57=_0x53f9eb;if(_0x542c01['roomName'])return;if(!_0x4e4fa1[_0x730a57(0x76)]||!_0x4e4fa1['dataId']){_0x4e4fa1[_0x730a57(0xa1)]='',io['to'](_0x373fba['id'])[_0x730a57(0xb2)](_0x730a57(0xb1),_0x4e4fa1);return;}if(!_0x4e4fa1['roomName']||!_0x4e4fa1[_0x730a57(0x75)]){_0x4e4fa1[_0x730a57(0xa1)]='部屋名・ユーザ名は\x201\x20文字以上必要です',io['to'](_0x373fba['id'])['emit'](_0x730a57(0xb1),_0x4e4fa1);return;}if(_0x4e4fa1['userName'][_0x730a57(0x7e)]>conf[_0x730a57(0xcf)]){_0x4e4fa1[_0x730a57(0xa1)]='ユーザ名は\x20'+conf['userNameMaxLength']+_0x730a57(0xd2),io['to'](_0x373fba['id'])[_0x730a57(0xb2)](_0x730a57(0xb1),_0x4e4fa1);return;}const _0x157e98=_0x4e4fa1[_0x730a57(0x76)]+'-'+_0x4e4fa1[_0x730a57(0xaf)]+'-'+_0x4e4fa1[_0x730a57(0x6d)],_0x984c42=rooms[_0x730a57(0xbf)](_0x157e98,_0x4e4fa1[_0x730a57(0x75)]);if(_0x984c42['success']){_0x542c01[_0x730a57(0x75)]=_0x4e4fa1[_0x730a57(0x75)],_0x542c01[_0x730a57(0x6d)]=_0x157e98,_0x373fba[_0x730a57(0xcb)](_0x542c01[_0x730a57(0x6d)]),_0x542c01[_0x730a57(0x9a)]=_0x984c42[_0x730a57(0x9a)],_0x3e9ce3=_0x542c01[_0x730a57(0x9a)][_0x730a57(0xbb)];const _0x3bc8a0=_0x542c01[_0x730a57(0x9a)][_0x730a57(0x92)]();io['to'](_0x542c01[_0x730a57(0x6d)])['emit'](_0x730a57(0x9c),_0x5da4c3(_0x542c01[_0x730a57(0x9a)]));}else{if(_0x984c42[_0x730a57(0xa1)]===_0x730a57(0x82))io['to'](_0x373fba['id'])[_0x730a57(0xb2)]('joinroom_playing_now',_0x4e4fa1);else{if(_0x984c42[_0x730a57(0xa1)]===_0x730a57(0xbe))io['to'](_0x373fba['id'])['emit'](_0x730a57(0x6f),_0x4e4fa1);else _0x984c42[_0x730a57(0xa1)]===_0x730a57(0x72)&&io['to'](_0x373fba['id'])[_0x730a57(0xb2)](_0x730a57(0x71),_0x4e4fa1);}}}),_0x373fba['on'](_0x53f9eb(0xcc),_0x30cac1=>{const _0x6209f3=_0x53f9eb;if(!_0x542c01[_0x6209f3(0x6d)])return;rooms['leaveMember'](_0x542c01['roomName'],_0x542c01[_0x6209f3(0x75)]),_0x373fba['leave'](_0x542c01['roomName']),!_0x542c01[_0x6209f3(0x9a)][_0x6209f3(0xd4)]?io['to'](_0x542c01['roomName'])['emit'](_0x6209f3(0x9c),_0x5da4c3(_0x542c01[_0x6209f3(0x9a)])):(_0x542c01[_0x6209f3(0x9a)][_0x6209f3(0xd4)]=![],io['to'](_0x542c01[_0x6209f3(0x6d)])[_0x6209f3(0xb2)](_0x6209f3(0xb9),Object[_0x6209f3(0x9f)]({'exitUserName':_0x542c01[_0x6209f3(0x75)]},_0x5da4c3(_0x542c01[_0x6209f3(0x9a)])))),_0x542c01[_0x6209f3(0x6d)]=null,_0x542c01[_0x6209f3(0x75)]=null,_0x542c01['room']=null,io['to'](_0x373fba['id'])[_0x6209f3(0xb2)](_0x6209f3(0x6e));}),_0x373fba['on']('disconnect',()=>{const _0x385712=_0x53f9eb;_0x542c01[_0x385712(0x6d)]&&(!_0x542c01['room'][_0x385712(0xd4)]?(rooms['leaveMember'](_0x542c01[_0x385712(0x6d)],_0x542c01[_0x385712(0x75)]),_0x373fba[_0x385712(0x84)](_0x542c01[_0x385712(0x6d)]),io['to'](_0x542c01[_0x385712(0x6d)])['emit'](_0x385712(0x9c),_0x5da4c3(_0x542c01['room']))):(_0x542c01[_0x385712(0x9a)][_0x385712(0xd4)]=![],rooms[_0x385712(0xab)](_0x542c01[_0x385712(0x6d)],_0x542c01[_0x385712(0x75)]),_0x373fba[_0x385712(0x84)](_0x542c01[_0x385712(0x6d)]),io['to'](_0x542c01[_0x385712(0x6d)])[_0x385712(0xb2)](_0x385712(0xb9),Object[_0x385712(0x9f)]({'exitUserName':_0x542c01[_0x385712(0x75)]},_0x5da4c3(_0x542c01[_0x385712(0x9a)])))));}),_0x373fba['on'](_0x53f9eb(0xcd),_0x15758c=>{const _0x9028ef=_0x53f9eb;_0x542c01['userName']===_0x542c01[_0x9028ef(0x9a)][_0x9028ef(0xaa)]?(_0x542c01[_0x9028ef(0x9a)][_0x9028ef(0xd4)]=![],io['to'](_0x542c01['roomName'])[_0x9028ef(0xb2)](_0x9028ef(0x90),_0x5da4c3(_0x542c01['room']))):io['to'](_0x373fba['id'])[_0x9028ef(0xb2)](_0x9028ef(0x90),_0x5da4c3(_0x542c01[_0x9028ef(0x9a)]));}),_0x373fba['on']('start_play',_0x3cf4d6=>{const _0x551ca7=_0x53f9eb;if(_0x542c01[_0x551ca7(0x75)]===_0x542c01[_0x551ca7(0x9a)][_0x551ca7(0xaa)]){_0x542c01[_0x551ca7(0x9a)]['play']=!![],_0x3e9ce3['readyCount']=0x0,_0x3e9ce3['memberCount']=_0x542c01[_0x551ca7(0x9a)][_0x551ca7(0xd1)][_0x551ca7(0x74)];const _0x4fdd28=_0x3cf4d6[_0x551ca7(0x79)],_0x2620a1=getRandomStrings(_0x4fdd28[_0x551ca7(0x7e)]);_0x4fdd28[_0x551ca7(0x8b)]((_0x2fb74f,_0x115631)=>_0x2fb74f[_0x551ca7(0x87)]=_0x2620a1[_0x115631]),_0x3e9ce3[_0x551ca7(0x8d)]=newRandomArray(_0x4fdd28)[_0x551ca7(0xc5)](0x0,_0x3cf4d6[_0x551ca7(0x98)]);const _0x17e5d0=_0x3e9ce3['restCards'][_0x551ca7(0x80)](_0x108c3a=>_0x108c3a[_0x551ca7(0x87)]);_0x3e9ce3[_0x551ca7(0xce)]=_0x3e9ce3[_0x551ca7(0x8d)][_0x551ca7(0x7e)],_0x3e9ce3[_0x551ca7(0xc1)][_0x551ca7(0xc8)](),_0x542c01[_0x551ca7(0x9a)][_0x551ca7(0xd1)][_0x551ca7(0x8b)](_0x237ab5=>{const _0x1fc1f2=_0x551ca7;_0x3e9ce3[_0x1fc1f2(0xc1)][_0x1fc1f2(0xb4)](_0x237ab5,{'userName':_0x237ab5,'correct':0x0,'wrong':0x0});}),io['to'](_0x542c01[_0x551ca7(0x6d)])[_0x551ca7(0xb2)](_0x551ca7(0x85),{'tagSeq':_0x2620a1,'displaySeq':_0x17e5d0,'showData':_0x346680()});}}),_0x373fba['on'](_0x53f9eb(0x95),()=>{const _0x464951=_0x53f9eb;++_0x3e9ce3['readyCount']===_0x542c01['room'][_0x464951(0xd1)]['size']&&(_0x3e9ce3['readyCount']=0x0,io['to'](_0x542c01[_0x464951(0x6d)])[_0x464951(0xb2)](_0x464951(0xa3)));}),_0x373fba['on']('ready_next_card',()=>{const _0x3a8723=_0x53f9eb;++_0x3e9ce3[_0x3a8723(0x78)]===_0x542c01['room'][_0x3a8723(0xd1)][_0x3a8723(0x74)]&&(io['to'](_0x542c01[_0x3a8723(0x6d)])[_0x3a8723(0xb2)](_0x3a8723(0xba)),_0x2babcd());});const _0x346680=(_0x1e5b18=![])=>{const _0x84be6a=_0x53f9eb,_0x71ad34=Array[_0x84be6a(0xc6)](_0x3e9ce3[_0x84be6a(0xc1)][_0x84be6a(0x8c)]()),_0xb6d840={'count':{'total':_0x3e9ce3[_0x84be6a(0xce)],'rest':_0x3e9ce3['restCards']['length']},'userResults':_0x71ad34['map'](_0x54a4a8=>Object['assign']({},_0x54a4a8))};return _0x1e5b18&&(_0xb6d840['rankedUserResults']=getRankedArray(_0x71ad34,(_0x214124,_0x130ff5)=>_0x214124[_0x84be6a(0xbc)]!==_0x130ff5[_0x84be6a(0xbc)]?-_0x214124[_0x84be6a(0xbc)]+_0x130ff5[_0x84be6a(0xbc)]:_0x214124[_0x84be6a(0xb5)]-_0x130ff5[_0x84be6a(0xb5)])),_0xb6d840;},_0x2babcd=()=>{const _0x29fd26=_0x53f9eb;if(_0x3e9ce3[_0x29fd26(0x8d)][_0x29fd26(0x7e)]<=0x1){io['to'](_0x542c01[_0x29fd26(0x6d)])['emit'](_0x29fd26(0xd0),_0x346680(!![]));return;}_0x3e9ce3[_0x29fd26(0x8f)]=getRandomRanged(0x0,_0x3e9ce3[_0x29fd26(0x8d)][_0x29fd26(0x7e)]),_0x3e9ce3[_0x29fd26(0x8e)]=_0x3e9ce3[_0x29fd26(0x8d)][_0x3e9ce3[_0x29fd26(0x8f)]],_0x3e9ce3[_0x29fd26(0xc4)]=_0x3e9ce3[_0x29fd26(0x8e)][_0x29fd26(0x87)],_0x3e9ce3[_0x29fd26(0x94)][_0x29fd26(0xc8)](),_0x3e9ce3[_0x29fd26(0xa9)]=Number[_0x29fd26(0xca)],_0x3e9ce3['fastestUserName']=null,io['to'](_0x542c01[_0x29fd26(0x6d)])[_0x29fd26(0xb2)]('next_card',{'currentTag':_0x3e9ce3['currentCard'][_0x29fd26(0x87)]});};_0x373fba['on'](_0x53f9eb(0xc9),_0x1180bc=>{const _0x4de7d3=_0x53f9eb;if(_0x3e9ce3[_0x4de7d3(0xc4)]!==_0x1180bc[_0x4de7d3(0xc4)])return;if(_0x1180bc[_0x4de7d3(0x75)]!==_0x542c01[_0x4de7d3(0x75)])return;if(_0x3e9ce3['actedDataMap'][_0x4de7d3(0xa4)](_0x542c01[_0x4de7d3(0x75)]))return;_0x3e9ce3[_0x4de7d3(0x94)][_0x4de7d3(0xb4)](_0x542c01['userName'],_0x1180bc),_0x1180bc[_0x4de7d3(0xb7)]===_0x4de7d3(0xac)&&_0x1180bc[_0x4de7d3(0xbc)]&&_0x1180bc[_0x4de7d3(0xb0)]===_0x3e9ce3[_0x4de7d3(0x8e)]['id']&&(_0x1180bc[_0x4de7d3(0x7f)]<_0x3e9ce3[_0x4de7d3(0xa9)]&&(_0x3e9ce3[_0x4de7d3(0xbd)]=_0x542c01['userName'],_0x3e9ce3[_0x4de7d3(0xa9)]=_0x1180bc[_0x4de7d3(0x7f)]),_0x1180bc[_0x4de7d3(0x91)]=(_0x1180bc[_0x4de7d3(0x7f)]/0x3e8)[_0x4de7d3(0x73)](0x2)),_0x3e9ce3['actedDataMap'][_0x4de7d3(0x74)]!==_0x3e9ce3[_0x4de7d3(0xd3)]?_0xdc62d9():_0x5578e5();});const _0x11fe0f=()=>{const _0xdbc9e2=_0x53f9eb;return Array[_0xdbc9e2(0xc6)](_0x3e9ce3[_0xdbc9e2(0x94)][_0xdbc9e2(0x8c)]());},_0xdc62d9=()=>{const _0xdcaf4d=_0x53f9eb;_0x3e9ce3[_0xdcaf4d(0xc4)]&&io['to'](_0x542c01[_0xdcaf4d(0x6d)])['emit'](_0xdcaf4d(0xa2),{'currentTag':_0x3e9ce3[_0xdcaf4d(0xc4)],'minTakenTimeMS':_0x3e9ce3['fastestUserName']?_0x3e9ce3['minTakenTimeMS']:null,'actionResults':_0x11fe0f()});},_0x5578e5=()=>{const _0x5becca=_0x53f9eb;if(_0x3e9ce3['currentTag']){const _0xf6e9b4=_0x3e9ce3[_0x5becca(0xc4)];_0x3e9ce3[_0x5becca(0xc4)]=null,_0x3e9ce3[_0x5becca(0x78)]=0x0;_0x3e9ce3[_0x5becca(0x94)][_0x5becca(0xa4)](_0x3e9ce3['fastestUserName'])&&_0x3e9ce3[_0x5becca(0x8d)][_0x5becca(0x99)](_0x3e9ce3[_0x5becca(0x8f)],0x1);_0x3e9ce3['userPointsMap'][_0x5becca(0x8b)](_0x1c97fa=>{const _0x34a726=_0x5becca,_0x2a9a86=_0x3e9ce3['actedDataMap']['get'](_0x1c97fa[_0x34a726(0x75)]);if(_0x2a9a86['userName']===_0x3e9ce3['fastestUserName'])_0x1c97fa[_0x34a726(0xbc)]++;else _0x2a9a86[_0x34a726(0xbc)]===![]&&_0x1c97fa[_0x34a726(0xb5)]++;});const _0x3059dd=Object[_0x5becca(0x9f)]({'card':{'currentTag':_0xf6e9b4,'cardId':_0x3e9ce3['currentCard']['id'],'winnerUserName':_0x3e9ce3[_0x5becca(0xbd)]}},_0x346680());_0x3059dd['actionResults']=_0x11fe0f(),io['to'](_0x542c01[_0x5becca(0x6d)])[_0x5becca(0xb2)](_0x5becca(0xa5),_0x3059dd);}};});