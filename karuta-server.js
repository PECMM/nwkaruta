const _0x385496=_0x1560;(function(_0x164f85,_0x29ed34){const _0x58d08c=_0x1560,_0x26d455=_0x164f85();while(!![]){try{const _0x7942f2=-parseInt(_0x58d08c(0x1f9))/0x1*(-parseInt(_0x58d08c(0x232))/0x2)+parseInt(_0x58d08c(0x1c5))/0x3+parseInt(_0x58d08c(0x1e0))/0x4+-parseInt(_0x58d08c(0x22d))/0x5+parseInt(_0x58d08c(0x1d2))/0x6*(-parseInt(_0x58d08c(0x22b))/0x7)+-parseInt(_0x58d08c(0x1ed))/0x8*(-parseInt(_0x58d08c(0x1c9))/0x9)+parseInt(_0x58d08c(0x205))/0xa*(-parseInt(_0x58d08c(0x204))/0xb);if(_0x7942f2===_0x29ed34)break;else _0x26d455['push'](_0x26d455['shift']());}catch(_0x139c58){_0x26d455['push'](_0x26d455['shift']());}}}(_0x1004,0x5d402));const newRandomArray=_0xdf75f2=>{const _0x3581c9=_0x1560,_0x140b7a=Array[_0x3581c9(0x226)](_0xdf75f2);for(let _0x51a3d3=_0x140b7a[_0x3581c9(0x1d3)]-0x1;_0x51a3d3>=0x0;_0x51a3d3--){const _0x5b52ab=Math[_0x3581c9(0x201)](Math[_0x3581c9(0x1fa)]()*(_0x51a3d3+0x1));[_0x140b7a[_0x51a3d3],_0x140b7a[_0x5b52ab]]=[_0x140b7a[_0x5b52ab],_0x140b7a[_0x51a3d3]];}return _0x140b7a;},nextRandomString=()=>{const _0x2ec425=_0x1560;return Math[_0x2ec425(0x1fa)]()['toString'](0x24)['substring'](0x2)[_0x2ec425(0x1dc)](0xb,'0');},getRandomStrings=_0x2600e6=>{const _0x5a2113=_0x1560,_0x20db0b=new Set();while(_0x20db0b[_0x5a2113(0x1e6)]<_0x2600e6){_0x20db0b[_0x5a2113(0x1fe)](nextRandomString());}return Array[_0x5a2113(0x226)](_0x20db0b);},getRandomRanged=(_0x25bc60,_0x277c06)=>{const _0x55b25c=_0x1560;return Math['floor'](_0x25bc60+Math[_0x55b25c(0x1fa)]()*(_0x277c06-_0x25bc60));},getRankedArray=(_0x3ae698,_0x2bce0f)=>{const _0x58fa37=_0x1560,_0x3ef551=_0x3ae698['map'](_0x3d5589=>Object[_0x58fa37(0x1eb)]({},_0x3d5589))[_0x58fa37(0x234)](_0x2bce0f);return _0x3ef551[_0x58fa37(0x215)]((_0x1d06e8,_0x36d18a,_0xba94c7)=>{const _0x4c70fb=_0x58fa37;return!_0x1d06e8?_0x36d18a[_0x4c70fb(0x21a)]=0x1:_0x36d18a[_0x4c70fb(0x21a)]=_0x2bce0f(_0x36d18a,_0x1d06e8)===0x0?_0x1d06e8[_0x4c70fb(0x21a)]:_0xba94c7+0x1,_0x36d18a;},null),_0x3ef551;},express=require('express'),app=express();app[_0x385496(0x223)](express[_0x385496(0x207)](_0x385496(0x20d)));const http=require('http')[_0x385496(0x1f3)](app);http[_0x385496(0x1e9)](process[_0x385496(0x1ff)][_0x385496(0x21b)]||0xbb8);const io=require(_0x385496(0x216))(http),rooms=((()=>{const _0x2cfe97=new Map(),_0x2f5c53=_0x32926c=>{return{'play':![],'game':{'actedDataMap':new Map(),'userPointsMap':new Map()},'ownerUserName':_0x32926c,'members':new Set([_0x32926c]),'getMemberList':function(){const _0x2e4ca7=_0x1560;return Array[_0x2e4ca7(0x226)](this[_0x2e4ca7(0x202)]);}};};return{'getMemberList':_0x4152e2=>{const _0x14f04a=_0x1560;return _0x2cfe97[_0x14f04a(0x1d9)](_0x4152e2)?.[_0x14f04a(0x1d1)]()??[];},'joinMember':(_0x3446ce,_0x1f4927,_0xed7090)=>{const _0x3af626=_0x1560;if(!_0x2cfe97[_0x3af626(0x1fb)](_0x3446ce)){const _0x3ea116=_0x2f5c53(_0x1f4927);return _0x2cfe97[_0x3af626(0x225)](_0x3446ce,_0x3ea116),{'success':!![],'room':_0x3ea116};}else{const _0x4ebd85=_0x2cfe97[_0x3af626(0x1d9)](_0x3446ce);if(_0x4ebd85[_0x3af626(0x1d4)])return{'success':![],'reason':_0x3af626(0x1da)};if(_0x4ebd85[_0x3af626(0x202)][_0x3af626(0x1e6)]>=conf['maxUserInRoom'])return{'success':![],'reason':_0x3af626(0x228)};return _0x4ebd85[_0x3af626(0x202)][_0x3af626(0x1fb)](_0x1f4927)?{'success':![],'reason':_0x3af626(0x1f6)}:(_0x4ebd85[_0x3af626(0x202)][_0x3af626(0x1fe)](_0x1f4927),{'success':!![],'room':_0x4ebd85});}},'leaveMember':(_0x54d5c4,_0x1d4188)=>{const _0x4e3731=_0x1560,_0x5d65e5=_0x2cfe97[_0x4e3731(0x1d9)](_0x54d5c4);if(!_0x5d65e5)return;const _0xc3de1c=_0x5d65e5[_0x4e3731(0x202)];_0xc3de1c[_0x4e3731(0x1e7)](_0x1d4188),_0xc3de1c[_0x4e3731(0x1e6)]===0x0&&_0x2cfe97['delete'](_0x54d5c4),_0x1d4188===_0x5d65e5[_0x4e3731(0x200)]&&(_0x5d65e5[_0x4e3731(0x200)]=_0xc3de1c[_0x4e3731(0x231)]()[_0x4e3731(0x1ee)]()[_0x4e3731(0x21c)]);}};})());function _0x1004(){const _0xbf3d30=['useCardCount','reduce','socket.io','initialize','userNameMaxLength','all_ready_next_card','rank','PORT','value','roomName','game','\x20...\x20','leave','reason','rankedUserResults','use','prepare_play','set','from','takenTimeMS','room_is_full','restCards','clear','31948qhLOVw','takenTimeSec','854195pdbOKQ','fastestUserName','appId','userPointsMap','values','48816TURjMO','click','sort','124506pYVtav','currentTag','dataId','finish_play','11691CKBJsT','game_end','leaveMember','readyCount','joinroom_room_is_full','toFixed','to_waiting_room','action','getMemberList','24IghcNm','length','play','forEach','./conf.json','emit','cardId','get','playing_now','部屋名・ユーザ名は\x201\x20文字以上必要です','padEnd','MAX_VALUE','leave_room','room','967524kFJUZA','sockets','wrong','map','totalCount','userName','size','delete','\x20文字以下にしてください','listen','all_ready_play','assign','currentIndex','2064SFoBVC','next','leave_room_ok','user_disconnect_in_game','card_phase_card_result','join_room','Server','progress:','log','duplicated_usename','joinroom_invaid_parameter','actionResults','19MjdkDV','random','has','room_member_list','joinroom_duplicated_usename','add','env','ownerUserName','floor','members','actedDataMap','1405877fVZFRx','40LQYbka','minTakenTimeMS','static','success','ready_next_card','disconnect','join','memberCount','public','ユーザ名は\x20','currentCard','correct','card_phase_acted','start_play','tag'];_0x1004=function(){return _0xbf3d30;};return _0x1004();}let userNumber=0x0;const conf=require(_0x385496(0x1d6));function _0x1560(_0x569ca6,_0x3b1c7b){const _0x1004eb=_0x1004();return _0x1560=function(_0x156059,_0x459aa0){_0x156059=_0x156059-0x1c5;let _0xe1fe88=_0x1004eb[_0x156059];return _0xe1fe88;},_0x1560(_0x569ca6,_0x3b1c7b);}io[_0x385496(0x1e1)]['on']('connection',_0x4e6c5d=>{const _0x284181=_0x385496,_0x54cf94={};let _0x1415b2;const _0xc1f361=_0x22a4d4=>{const _0x19d93f=_0x1560,_0x55eaed=0x10;console[_0x19d93f(0x1f5)](_0x19d93f(0x1f4)+_0x22a4d4[_0x19d93f(0x1dc)](_0x55eaed)+_0x19d93f(0x21f)+_0x54cf94['roomName']+_0x19d93f(0x21f),Array[_0x19d93f(0x226)](_0x54cf94[_0x19d93f(0x1df)][_0x19d93f(0x202)])['join'](','));};io['to'](_0x4e6c5d['id'])[_0x284181(0x1d7)](_0x284181(0x217),{'userNameMaxLength':conf[_0x284181(0x218)],'userNumber':++userNumber});const _0x2c354d=_0x32e9cb=>{const _0x3d6809=_0x284181;return{'memberList':_0x32e9cb[_0x3d6809(0x1d1)](),'ownerUserName':_0x32e9cb[_0x3d6809(0x200)]};};_0x4e6c5d['on'](_0x284181(0x1f2),_0x570077=>{const _0x21f226=_0x284181;if(_0x54cf94[_0x21f226(0x21d)])return;if(!_0x570077[_0x21f226(0x22f)]||!_0x570077[_0x21f226(0x1c7)]){_0x570077['reason']='',io['to'](_0x4e6c5d['id'])[_0x21f226(0x1d7)](_0x21f226(0x1f7),_0x570077);return;}if(!_0x570077['roomName']||!_0x570077[_0x21f226(0x1e5)]){_0x570077[_0x21f226(0x221)]=_0x21f226(0x1db),io['to'](_0x4e6c5d['id'])[_0x21f226(0x1d7)]('joinroom_invaid_parameter',_0x570077);return;}if(_0x570077['userName'][_0x21f226(0x1d3)]>conf[_0x21f226(0x218)]){_0x570077['reason']=_0x21f226(0x20e)+conf[_0x21f226(0x218)]+_0x21f226(0x1e8),io['to'](_0x4e6c5d['id'])[_0x21f226(0x1d7)](_0x21f226(0x1f7),_0x570077);return;}const _0x41f1a5=_0x570077[_0x21f226(0x22f)]+'-'+_0x570077[_0x21f226(0x1c7)]+'-'+_0x570077[_0x21f226(0x21d)],_0x5dcc90=rooms['joinMember'](_0x41f1a5,_0x570077[_0x21f226(0x1e5)]);if(_0x5dcc90[_0x21f226(0x208)]){_0x54cf94[_0x21f226(0x1e5)]=_0x570077[_0x21f226(0x1e5)],_0x54cf94[_0x21f226(0x21d)]=_0x41f1a5,_0x4e6c5d[_0x21f226(0x20b)](_0x54cf94[_0x21f226(0x21d)]),_0x54cf94['room']=_0x5dcc90[_0x21f226(0x1df)],_0x1415b2=_0x54cf94['room'][_0x21f226(0x21e)];const _0x264e23=_0x54cf94[_0x21f226(0x1df)][_0x21f226(0x1d1)]();io['to'](_0x54cf94[_0x21f226(0x21d)])[_0x21f226(0x1d7)](_0x21f226(0x1fc),_0x2c354d(_0x54cf94['room']));}else{if(_0x5dcc90['reason']==='playing_now')io['to'](_0x4e6c5d['id'])[_0x21f226(0x1d7)]('joinroom_playing_now',_0x570077);else{if(_0x5dcc90[_0x21f226(0x221)]===_0x21f226(0x1f6))io['to'](_0x4e6c5d['id'])[_0x21f226(0x1d7)](_0x21f226(0x1fd),_0x570077);else _0x5dcc90['reason']===_0x21f226(0x228)&&io['to'](_0x4e6c5d['id'])['emit'](_0x21f226(0x1cd),_0x570077);}}}),_0x4e6c5d['on'](_0x284181(0x1de),_0x1cced5=>{const _0xdc722e=_0x284181;if(!_0x54cf94[_0xdc722e(0x21d)])return;rooms[_0xdc722e(0x1cb)](_0x54cf94[_0xdc722e(0x21d)],_0x54cf94[_0xdc722e(0x1e5)]),_0x4e6c5d['leave'](_0x54cf94[_0xdc722e(0x21d)]),!_0x54cf94['room'][_0xdc722e(0x1d4)]?io['to'](_0x54cf94['roomName'])[_0xdc722e(0x1d7)]('room_member_list',_0x2c354d(_0x54cf94[_0xdc722e(0x1df)])):(_0x54cf94[_0xdc722e(0x1df)][_0xdc722e(0x1d4)]=![],_0xc1f361('leave_room'),io['to'](_0x54cf94[_0xdc722e(0x21d)])[_0xdc722e(0x1d7)]('user_disconnect_in_game',Object['assign']({'exitUserName':_0x54cf94['userName']},_0x2c354d(_0x54cf94[_0xdc722e(0x1df)])))),_0x54cf94['roomName']=null,_0x54cf94[_0xdc722e(0x1e5)]=null,_0x54cf94[_0xdc722e(0x1df)]=null,io['to'](_0x4e6c5d['id'])[_0xdc722e(0x1d7)](_0xdc722e(0x1ef));}),_0x4e6c5d['on'](_0x284181(0x20a),()=>{const _0x35c661=_0x284181;_0x54cf94['roomName']&&(!_0x54cf94[_0x35c661(0x1df)][_0x35c661(0x1d4)]?(rooms[_0x35c661(0x1cb)](_0x54cf94[_0x35c661(0x21d)],_0x54cf94[_0x35c661(0x1e5)]),_0x4e6c5d[_0x35c661(0x220)](_0x54cf94[_0x35c661(0x21d)]),io['to'](_0x54cf94['roomName'])[_0x35c661(0x1d7)](_0x35c661(0x1fc),_0x2c354d(_0x54cf94[_0x35c661(0x1df)]))):(_0x54cf94[_0x35c661(0x1df)]['play']=![],_0xc1f361(_0x35c661(0x20a)),rooms[_0x35c661(0x1cb)](_0x54cf94[_0x35c661(0x21d)],_0x54cf94[_0x35c661(0x1e5)]),_0x4e6c5d[_0x35c661(0x220)](_0x54cf94[_0x35c661(0x21d)]),io['to'](_0x54cf94['roomName'])[_0x35c661(0x1d7)](_0x35c661(0x1f0),Object[_0x35c661(0x1eb)]({'exitUserName':_0x54cf94[_0x35c661(0x1e5)]},_0x2c354d(_0x54cf94[_0x35c661(0x1df)])))));}),_0x4e6c5d['on'](_0x284181(0x1c8),_0x46728f=>{const _0x4e15cc=_0x284181;_0x54cf94['userName']===_0x54cf94[_0x4e15cc(0x1df)]['ownerUserName']?(_0x54cf94[_0x4e15cc(0x1df)][_0x4e15cc(0x1d4)]=![],io['to'](_0x54cf94[_0x4e15cc(0x21d)])[_0x4e15cc(0x1d7)]('to_waiting_room',_0x2c354d(_0x54cf94[_0x4e15cc(0x1df)]))):io['to'](_0x4e6c5d['id'])['emit'](_0x4e15cc(0x1cf),_0x2c354d(_0x54cf94['room']));}),_0x4e6c5d['on'](_0x284181(0x212),_0x438704=>{const _0x387deb=_0x284181;if(_0x54cf94[_0x387deb(0x1e5)]===_0x54cf94[_0x387deb(0x1df)]['ownerUserName']){_0xc1f361('start_play'),_0x54cf94[_0x387deb(0x1df)][_0x387deb(0x1d4)]=!![],_0x1415b2['readyCount']=0x0,_0x1415b2[_0x387deb(0x20c)]=_0x54cf94[_0x387deb(0x1df)]['members'][_0x387deb(0x1e6)];const _0x507473=_0x438704['cards'],_0x353137=getRandomStrings(_0x507473[_0x387deb(0x1d3)]);_0x507473['forEach']((_0x1db180,_0xc1a524)=>_0x1db180[_0x387deb(0x213)]=_0x353137[_0xc1a524]),_0x1415b2['restCards']=newRandomArray(_0x507473)['slice'](0x0,_0x438704[_0x387deb(0x214)]);const _0x2fd279=_0x1415b2[_0x387deb(0x229)][_0x387deb(0x1e3)](_0x4dfa86=>_0x4dfa86[_0x387deb(0x213)]);_0x1415b2[_0x387deb(0x1e4)]=_0x1415b2[_0x387deb(0x229)][_0x387deb(0x1d3)],_0x1415b2['userPointsMap']['clear'](),_0x54cf94[_0x387deb(0x1df)]['members']['forEach'](_0xa3b099=>{const _0x1b7461=_0x387deb;_0x1415b2['userPointsMap'][_0x1b7461(0x225)](_0xa3b099,{'userName':_0xa3b099,'correct':0x0,'wrong':0x0});}),io['to'](_0x54cf94[_0x387deb(0x21d)])[_0x387deb(0x1d7)](_0x387deb(0x224),{'tagSeq':_0x353137,'displaySeq':_0x2fd279,'showData':_0x556fa6()});}}),_0x4e6c5d['on']('ready_play',()=>{const _0x47cfca=_0x284181;++_0x1415b2[_0x47cfca(0x1cc)]===_0x54cf94[_0x47cfca(0x1df)][_0x47cfca(0x202)][_0x47cfca(0x1e6)]&&(_0x1415b2[_0x47cfca(0x1cc)]=0x0,io['to'](_0x54cf94[_0x47cfca(0x21d)])[_0x47cfca(0x1d7)](_0x47cfca(0x1ea)));}),_0x4e6c5d['on'](_0x284181(0x209),()=>{const _0x324cac=_0x284181;++_0x1415b2[_0x324cac(0x1cc)]===_0x54cf94['room'][_0x324cac(0x202)][_0x324cac(0x1e6)]&&(io['to'](_0x54cf94['roomName'])[_0x324cac(0x1d7)](_0x324cac(0x219)),_0x3238ce());});const _0x556fa6=(_0xfc2860=![])=>{const _0x15b27c=_0x284181,_0x43a478=Array['from'](_0x1415b2[_0x15b27c(0x230)][_0x15b27c(0x231)]()),_0x5cb232={'count':{'total':_0x1415b2[_0x15b27c(0x1e4)],'rest':_0x1415b2[_0x15b27c(0x229)]['length']},'userResults':_0x43a478['map'](_0x271260=>Object['assign']({},_0x271260))};return _0xfc2860&&(_0x5cb232[_0x15b27c(0x222)]=getRankedArray(_0x43a478,(_0x595ad1,_0x304825)=>_0x595ad1[_0x15b27c(0x210)]!==_0x304825[_0x15b27c(0x210)]?-_0x595ad1['correct']+_0x304825[_0x15b27c(0x210)]:_0x595ad1[_0x15b27c(0x1e2)]-_0x304825[_0x15b27c(0x1e2)])),_0x5cb232;},_0x3238ce=()=>{const _0x1c3ab6=_0x284181;if(_0x1415b2[_0x1c3ab6(0x229)]['length']<=0x1){io['to'](_0x54cf94['roomName'])['emit'](_0x1c3ab6(0x1ca),_0x556fa6(!![])),_0xc1f361(_0x1c3ab6(0x1ca));return;}_0x1415b2[_0x1c3ab6(0x1ec)]=getRandomRanged(0x0,_0x1415b2[_0x1c3ab6(0x229)]['length']),_0x1415b2[_0x1c3ab6(0x20f)]=_0x1415b2['restCards'][_0x1415b2[_0x1c3ab6(0x1ec)]],_0x1415b2[_0x1c3ab6(0x1c6)]=_0x1415b2[_0x1c3ab6(0x20f)][_0x1c3ab6(0x213)],_0x1415b2[_0x1c3ab6(0x203)][_0x1c3ab6(0x22a)](),_0x1415b2['minTakenTimeMS']=Number[_0x1c3ab6(0x1dd)],_0x1415b2[_0x1c3ab6(0x22e)]=null,io['to'](_0x54cf94[_0x1c3ab6(0x21d)])['emit']('next_card',{'currentTag':_0x1415b2[_0x1c3ab6(0x20f)][_0x1c3ab6(0x213)]});};_0x4e6c5d['on'](_0x284181(0x211),_0xccdc44=>{const _0x194e42=_0x284181;if(_0x1415b2[_0x194e42(0x1c6)]!==_0xccdc44[_0x194e42(0x1c6)])return;if(_0xccdc44['userName']!==_0x54cf94[_0x194e42(0x1e5)])return;if(_0x1415b2['actedDataMap']['has'](_0x54cf94['userName']))return;_0x1415b2[_0x194e42(0x203)][_0x194e42(0x225)](_0x54cf94[_0x194e42(0x1e5)],_0xccdc44),_0xccdc44[_0x194e42(0x1d0)]===_0x194e42(0x233)&&_0xccdc44[_0x194e42(0x210)]&&_0xccdc44[_0x194e42(0x1d8)]===_0x1415b2[_0x194e42(0x20f)]['id']&&(_0xccdc44['takenTimeMS']<_0x1415b2[_0x194e42(0x206)]&&(_0x1415b2[_0x194e42(0x22e)]=_0x54cf94['userName'],_0x1415b2['minTakenTimeMS']=_0xccdc44[_0x194e42(0x227)]),_0xccdc44[_0x194e42(0x22c)]=(_0xccdc44['takenTimeMS']/0x3e8)[_0x194e42(0x1ce)](0x2)),_0x1415b2[_0x194e42(0x203)][_0x194e42(0x1e6)]!==_0x1415b2[_0x194e42(0x20c)]?_0x221924():_0x39422d();});const _0x367330=()=>{const _0x2c51c8=_0x284181;return Array[_0x2c51c8(0x226)](_0x1415b2[_0x2c51c8(0x203)][_0x2c51c8(0x231)]());},_0x221924=()=>{const _0xf165a=_0x284181;_0x1415b2['currentTag']&&io['to'](_0x54cf94[_0xf165a(0x21d)])[_0xf165a(0x1d7)]('card_phase_update_actinfo',{'currentTag':_0x1415b2['currentTag'],'minTakenTimeMS':_0x1415b2[_0xf165a(0x22e)]?_0x1415b2[_0xf165a(0x206)]:null,'actionResults':_0x367330()});},_0x39422d=()=>{const _0x54765b=_0x284181;if(_0x1415b2[_0x54765b(0x1c6)]){const _0x2d5603=_0x1415b2[_0x54765b(0x1c6)];_0x1415b2[_0x54765b(0x1c6)]=null,_0x1415b2[_0x54765b(0x1cc)]=0x0;_0x1415b2[_0x54765b(0x203)][_0x54765b(0x1fb)](_0x1415b2[_0x54765b(0x22e)])&&_0x1415b2[_0x54765b(0x229)]['splice'](_0x1415b2[_0x54765b(0x1ec)],0x1);_0x1415b2[_0x54765b(0x230)][_0x54765b(0x1d5)](_0x3ed5a3=>{const _0x165e46=_0x54765b,_0x496720=_0x1415b2[_0x165e46(0x203)][_0x165e46(0x1d9)](_0x3ed5a3[_0x165e46(0x1e5)]);if(_0x496720[_0x165e46(0x1e5)]===_0x1415b2[_0x165e46(0x22e)])_0x3ed5a3[_0x165e46(0x210)]++;else _0x496720[_0x165e46(0x210)]===![]&&_0x3ed5a3['wrong']++;});const _0x154a5a=Object[_0x54765b(0x1eb)]({'card':{'currentTag':_0x2d5603,'cardId':_0x1415b2[_0x54765b(0x20f)]['id'],'winnerUserName':_0x1415b2['fastestUserName']}},_0x556fa6());_0x154a5a[_0x54765b(0x1f8)]=_0x367330(),io['to'](_0x54cf94[_0x54765b(0x21d)])[_0x54765b(0x1d7)](_0x54765b(0x1f1),_0x154a5a);}};});